function y = homografia(x1,x2,x3,x4,x1p,x2p,x3p,x4p) 
  A=[x1(1),x1(2),1,0,0,0,-x1(1)*x1p(1),-x1(2)*x1p(1);
    0,0,0,x1(1),x1(2),1,-x1(1)*x1p(2),-x1(2)*x1p(2);
    x2(1),x2(2),1,0,0,0,-x2(1)*x2p(1),-x2(2)*x2p(1);
    0,0,0,x2(1),x2(2),1,-x2(1)*x2p(2),-x2(2)*x2p(2);
    x3(1),x3(2),1,0,0,0,-x3(1)*x3p(1),-x3(2)*x3p(1);
    0,0,0,x3(1),x3(2),1,-x3(1)*x3p(2),-x3(2)*x3p(2);
    x4(1),x4(2),1,0,0,0,-x4(1)*x4p(1),-x4(2)*x4p(1);
    0,0,0,x4(1),x4(2),1,-x4(1)*x4p(2),-x4(2)*x4p(2)];
  b=[x1p(1),x1p(2),x2p(1),x2p(2),x3p(1),x3p(2),x4p(1),x4p(2)]';
  h=A\b;
  H=[h(1),h(2),h(3);h(4),h(5),h(6);h(7),h(8),1]
  endfunction 